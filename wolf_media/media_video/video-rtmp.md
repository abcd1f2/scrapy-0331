## media-video rtmp
- **概述：**
>       RTMP协议从属于应用层，被设计用来在适合的传输协议（如TCP）上复用和打包多媒体传输流（如音频、视频和互动内容）
>       RTMP提供了一套全双工的可靠的多路复用消息服务，类似于TCP协议[RFC0793]，用来在一对结点之间并行传输带时间戳的音频流，视频流，数据流。
>       通常情况下，不同类型的消息会被分配不同的优先级，当网络传输能力受限时，优先级用来控制消息在网络底层的排队顺序。
>

- **RTMP基础：**
>       RTMP块流被设计用来传输实时消息协议，它可以使用任何协议来发送消息流。
>       通常情况下，不同类型的消息会被分配不同的优先级，当网络传输能力受限时，优先级用来控制消息在网络底层的排队顺序。
>       每个消息都包含时间戳和有效类型标识。
>       RTMP块流和RTMP适用于各种视听传播的应用程序，包括一对一的，和一对多的视频直播、点播服务、互动会议应用程序。
>       当使用一个可靠的传输协议如TCP[RFC0793]时，RTMP块流提供了一种可以在多个流中，基于时间戳的端到端交付所有消息的方法
>       RTMP块流不提供任何优先级或类似形式的控制，但可以使用更高级别的协议来提供这样的优先级
>       RTMP块流不仅包含了自己的协议控制信息，同时也提供了一个更高级别的协议机制，用来嵌入用户控制信息
>

- **RMTP消息：**
>       RMTP消息被分割成多个块，用来在更高的协议中支持多路复用。在消息格式时，应该包含以下字段：
>           1、时间戳
>               消息的时间戳。这个字段占用4字节
>           2、长度
>               消息的有效长度。如果消息头不能被忽略，它应该包括长度。这个字段在块头中占用3字节
>           3、类型ID
>               各种类型的协议控制消息的ID。
>               这些消息使用RTMP块流协议和更高级别的协议来传输信息。所有其他类型的ID可以用在高级协议，这对于RTMP块流来说，是不透明的。
>               事实上，RTMP块流中没有要求使用这些值作为类型；所有(无协议的)消息可能是相同的类型，或者应用程序使用这个字段来区分多个连接，而不是类型。这个字段在块头中占用1字节。
>           4、消息流ID
>               消息流ID可以是任意值。
>               当同一个块流被复用到不同的消息流中时，可以通过消息流ID来区分它们。
>               另外，对于RTMP块流而言，这是一个不透明值。该字段占用4字节，使用小端序。
>

- **rtmp消息协议：**
>       RTMP协议中基本的数据单元称为消息（Message）
>       当RTMP协议在互联网中传输数据的时候，消息会被拆分成更小的单元，称为消息块（Chunk）
>
>       rtmp消息包使用的是二进制数据流,它们使用AMF0/AMF3进行编码。
>       与其它协议一样,rtmp消息也是也包括消息头与消息体,而消息头又可以分为basic header,chunk header,timestamp
>       1、chunk basic header
>           basic header是此包的唯一不变的部分,并且由一个独立的byte构成,这其中包括了2个作重要的标志位,chunk type以及stream id。
>               chunk type决定了消息头的编码格式,该字段的长度完全依赖于stream id,stream id是一个可变长的字段
>       2、chunk message header
>           message header该字段包含了将要发送的消息的信息(或者是一部分,一个消息拆成多个chunk的情况下是一部分)
>           该字段的长度由chunk basic header中的trunk type决定
>       3、extended timestamp
>           timestamp扩展时间戳就比较好理解的,就是当chunk message header的时间戳大于等于0xffffff的时候chunk message header后面的四个字节就代表扩展时间
>

- **握手协议：**
>       在rtmp连接建立后,服务端与客户端需要通过3次交换报文完成握手
>       握手其他的协议不同,是由三个静态大小的块,而不是可变大小的块组成的。
>
>
>
>
>
>
>
>

- **rtmp协议分包：**
>       在RTMP协议中对应的说法就是chunk，每一个Message + head都是由一个和多个chunk组成的
>       一个Message + head可以分成一个和多个chunk，为了区分这些chunk，肯定是需要一个chunk head的，具体的实现就把Message head的信息和chunk head的信息合并在一起以chunk head的形式表现
>

- **待续：**
>       参考：https://mingyangshang.github.io/2016/03/06/RTMP%E5%8D%8F%E8%AE%AE/   带你吃透RTMP
>           https://blog.csdn.net/xiangzhihong8/article/details/68560237    实时消息传输协议（RTMP）详解
>           https://www.cnblogs.com/rongpmcu/p/7662200.html     rtmp服务端实现
>           https://segmentfault.com/a/1190000018582618     理解RTMP协议——chunk格式
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
