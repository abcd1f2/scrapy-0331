## NLP-应用分享 - 猎户星空nlp技术发展及其应用
- **概述：**
>
>       本文介绍了四个方面的内容：
>           1、人机交互
>           2、猎户在NLP提供的能力
>           3、猎户的NLP具体技术实现细节
>           4、猎户的NLP的产品落地
>

- **人机交互：**
>
>       人机交互分为两个部分：
>           1、端
>               信号层的算法处理
>           2、云
>               主要进行语音识别的一些自然语言处理，对话管理以及和资源相关的工作
>           如图，
> ![avatar](https://github.com/nwaiting/wolf-ai/blob/master/wolf_others/pic/liehu_people_with_machine.jpg)
>
>       人机交互后端流程：
>           将端上获取的音频信号传到云端之后，
>           1、通过ASR，将音频转换成文本，以便后端进行决策
>           2、通过NLU理解意图，获取说话内容的关键信息
>           3、DST对话状态跟踪模块属于上下文功能，通过Policy Ranking决策出用户意图和相应的action
>           4、由NLG模块生成机器要表达的想法，通过TTS将文本转化为音频传给前端
>
>       难点：
>           1、端获取语言的环境和口音
>           2、不同垂直行业，对理解的差异化很大（对于ASR和NLP，如果没有垂直行业知识的预练，效果很不好）
>           3、不同的硬件设备对理解有不同需求
>           4、语义理解和知识图谱等认知技术没有通用框架
>           5、用户表达的多样性、随意性、隐喻、上下文等
>

- **猎户的NLP能力：**
>
>       目的：
>           猎户星空NLP团队主要使用NLP技术，提供语言理解和智能决策服务，为猎豹猎户相关智能硬件赋予大脑能力
>
>       猎户提供的与服务功能：
>           1、智能交互服务
>               NLP服务对外提供的平台架构服务，调用NLU、chat、QA、开放平台、第三方技能服务，做综合决策
>           2、自然语言理解
>               理解用户的每一句话，指导做出正确的动作
>           3、智能对话
>               针对用户对机器的多轮交互，维护上下文状态，理解用户当前query在上文条件下的准确意图，执行正确动作
>           4、问答聊天
>               给出正确答案，对用户的问句，给出具备情感和亲和力的答案，增加用户粘性
>           5、用户画像服务
>               通过用户行为，建模用户特征，用于个性化聊天
>           6、机器翻译
>               基于深度学习构建翻译模型
>

- **猎户NLP的技术细节：**
>
>       猎户NLP架构：
>           猎户NLP总共分三层，模型算法层、架构层（通过服务架构层把所有底层算法能力以平台方式输出）、产品应用层
>
>       猎户NLP技术细节：
>           1、自然语言理解
>           2、智能问答
>           3、用户画像
>           4、聊天系统
>

- **猎户NLP技术细节-自然语言理解：**
>
>       目的：
>           理解用户说的话，输出结构化语义表示。
>           难点：用户说话的多样性、口语歧义、语义边界模糊、修改语义复合语义记忆上下文相关联等
>
>       NLU的技术架构：
>           如下图，
> ![avatar](https://github.com/nwaiting/wolf-ai/blob/master/wolf_others/pic/liehu_NLU_architecture.jpg)
>
>       中间部分：
>           线上服务，输入是query/ASR解码路径/content/用户信息/语境等内容
>           1、首先是进行query预处理/语法分析/句法分析/实体识别和消歧/短语识别/实体纠错/指代消解等
>           2、然后是领域意图分析
>               利用前层语法分析结果判断用户在哪个领域以及具体在问哪方面的问题
>           3、然后是语义槽抽取
>               在当前领域下对用户query的槽位进行抽取，对领域和槽位进行综合管理得出用户真正的意图做一个结构化的输出
>
>       离线处理：
>           离线数据标注和数据挖掘
>           线上的大量日志具有两个方面的作用：
>               1、随机抽取样本进行每日的效果监控
>               2、通过active learning筛选出系统最薄弱的环节，对最薄弱的环节的数据进行人工标注后混入训练模型，可以明显提升效果。
>
>       开发平台-**数据处理**：
>           数据主要有两个部分
>           1、词典资源数据
>               对于NLU这部分的词典资源数据的清洗是非常重要的，一般直接拿来的数据无论是音乐数据还是有声节目数据都带有很大的噪声。
>               **资源清洗：**
>                   这部分需要消耗大量的人力，非常重要，如果资源清洗不好，线上的NLU效果会很差，必须通过规则对数据进行大量清洗。！！！
>           2、线上数据
>
>           还有一个数据处理：
>               无论是媒体资源、歌曲还是有声节目等，资源名之间会有大量的冲突和复用情况，需要确定该资源属于常用资源还是有歧义的资源，以及有些资源与常用语有冲突。
>
>       数据应用：
>           在得到数据后开始做NLU，目前是基于CFG搭建的一个端到端的语义理解引擎，支持通配、量词、上下文等。**直接输出领域、意图和槽位。**
>           **端到端的文法语义理解用于领域在冷启动阶段的语义解析，NLU的新需求大多基于此进行快速开发。**
>           积累数据后如何提升效果？？？
>               在积累了大量的线上数据之后，唯一的途径就是通过数据标注加模型训练来提升效果。
>           如下图，
> ![avatar](https://github.com/nwaiting/wolf-ai/blob/master/wolf_others/pic/liehu_semantics_understand_CFG.jpg)
>
>       领域和意图分类：
>           将领域分类模块替换为模型，基于LSTM做了一个模型层面的意图和领域分类模型，**输入是两维特征：字向量和实体识别特征，作为所有意图分类模型基础输入。**
>           模型由一个双向LSTM加一个单向的LSTM构成，最后通过softmax做一个领域的选择。
>           意图分类同样是基于此模型，在领域分类上准确率达到了93%，在意图分类上准确率达到了96%。
>
>       槽位抽取：
>           如下图，
> ![avatar](https://github.com/nwaiting/wolf-ai/blob/master/wolf_others/pic/liehu_NLU_slot.jpg)
>
>           **槽位抽取分类两种方法：！！！**
>               1、基于pattern的抽取
>               2、基于模型的抽取
>                   模型采用比较成熟的BiLSTM+CRF，线上总体准确率达到了92%
>                   BiLSTM内层特征可以做一些共享和互补，这对系统的整体效果是有帮助的，
>                   **借鉴了一些公开论文做了一个联合学习模型，将slot抽取和意图分类最终做了一个统一的损失函数输出，获得了一个统一的模型。**
>                   联合学习模型在全局进行意图分类和槽位抽取，槽位抽取采用CRF做最终打标，意图分类也是softmax，但在最上层将两个loss进行相加，相加之后反向传播所有的误差来更新模型参数。
>                   如下图，
> ![avatar](https://github.com/nwaiting/wolf-ai/blob/master/wolf_others/pic/liehu_NLU_combined_model.jpg)
>
>       相对于意图分类和槽位抽取模型，联合模型取得了较大的效果：
>           如下图，
> ![avatar](https://github.com/nwaiting/wolf-ai/blob/master/wolf_others/pic/liehu_NLU_union_model_effect.jpg)
>

- **智能问答**
>
>       智能问答本质上是用户提出问题，回复正确的答案，
>       技术点：
>           1、问句分析，通过对用户query的理解解析出query是在做哪方面数据库的查询
>           2、知识库构建
>           3、答案生成
>       实现方法有三种：
>           1、基于检索QA系统
>           2、基于知识图谱的QA系统
>           3、问答阅读理解
>
>       检索QA系统：
>           基于检索问答有两个难点，
>           1、知识库构建
>           2、句子相似度计算
>           如下图，
> ![avatar](https://github.com/nwaiting/wolf-ai/blob/master/wolf_others/pic/liehu_NLU_search_QA.jpg)
>
>           **线上实际应用：！！！**
>               目前线上使用系统主要是基于检索式的智能问答系统，处理流程为：
>                   1、对query先进行normalization
>                   2、根据离线构建的知识库构建出与用户最相似的query，做语义相似度计算，
>                   3、对结果进行rank后得到answer
>               异常处理：
>                   由于ASR存在许多识别错误，因此需要做一些拼音层面的模糊匹配，实体相关的模糊反查等相关异常处理
>
>       检索QA系统架构：
>           如下图，
> ![avatar](https://github.com/nwaiting/wolf-ai/blob/master/wolf_others/pic/liehu_search_QA_architecture_simple.jpg)
>
>           整体架构图，
> ![avatar](https://github.com/nwaiting/wolf-ai/blob/master/wolf_others/pic/liehu_search_QA_architecture_full.jpg)
>
>
>

- **用户画像：**
>
>       用户画像根据设备ID和声纹来唯一指定一个用户。
>
>

- **聊天系统：**
>
>       略
>
>
>
>
>
>
>
>
>
>
>

- **待续：**
>       参考：https://mp.weixin.qq.com/s/kUrB0SLp-3J970e0vr6dzg
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
