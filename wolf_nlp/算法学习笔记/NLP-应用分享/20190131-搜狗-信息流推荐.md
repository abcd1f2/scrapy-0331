## NLP-应用分享 - 搜狗信息流推荐算法交流
- **概述：**
>
>       本文主要介绍4个内容：
>           1、推荐系统架构
>           2、文章NLP
>           3、召回算法
>           4、个性化推荐
>
>

- **推荐系统架构：**
>
>       如下图，
> ![avatar](https://github.com/nwaiting/wolf-ai/blob/master/wolf_others/pic/sougou_feeds_recommend_architecture.jpg)
>
>       如果所示，这是一个经典的推荐系统架构，
>       数据源：
>           抓取、合作或者自媒体产生
>       NLP处理：
>           作用就是对文章进行抽象，用关键的topic进行概括出来
>       召回层：
>           通过用户的兴趣和点击把用户需要的文章召回出来，进行浓缩，从亿级文章到千级的量级
>       推荐给客户端：
>           根据点击操作反馈更新用户画像
>

- **文章NLP：**
>
>       推荐系统中，主要是对文章进行分类和打标签
>       对文章分类，有多个维度，主要有三个简单维度体系。比如类似于头条中的文本多分类，采用层次分类架构。
>           分类：
>               比如一篇文章是属于体育、科技等
>           标签：
>               标签是属于一部分分类，也是一个集合，比如NBA标签属于分类。
>           关键词：
>               属于实体的集合，比如火箭队、乔丹、综艺节目等
>           整个文章形成一套有结构的组织，每一层体系都能代表用户的兴趣级别。
>
>       三个层级如何计算：
>           分类：（通常一个文章只有一个分类）
>               采用**fasttext多分类模型**，训练是时候每个分类分别收集几十万的文章。
>               1、开始简单的用fasttext模型进行文本多分类
>                   最开始把content和title放在一起，作为文本输入到神经网络中进行分类，分类效果还可以
>               2、由于title和content权重不一样，所以把title和content分成两部分进行fasttext训练，在进行全连接，进行多分类，
>                   这样准确率能达到93%
>               3、后续优化除了使用fasttext还进行了多模型的融合
>                   使用多个模型融合再进行投票，最终准确率达到了96%
>               如下图，
> ![avatar](https://github.com/nwaiting/wolf-ai/blob/master/wolf_others/pic/sougou_feeds_multi_textclassification.jpg)
>
>           标签：（一个文章可能有多个标签）
>               标签只有几百个，都是人为总结出来的，描述比较精确。
>               每个标签都是对应分类当中的，在计算标签的时候使用TextCNN分类模型，每个标签收集几万篇文章进行训练。
>               TextCNN分类模型和fasttext模型不一样，fasttext对于一个文章只会分到对应的一个分类中，标签不一样，标签是有多个。
>               **TextCNN分类模型**进行了卷积计算，能在更高维度理解标签的定义。
>
>               标签分类模型架构：
>                   把标题和正文分开进行卷积，用两层卷积，在进行两层全连接，最后输出一个分类。
>               数据增强处理：
>                   为了时分类效果好，进行了数据增强的处理，比如单篇文章拆分成多个样本，在预测的时候把整篇文章拆成多段文本进行预测拟合，最后进行投票确定最终标签。
>               实验结果对比：
>                   fasttext能达到75%，TextCNN能达到88%，采用"TextCNN+数据增强+多段结果预测"能达到90%，用RNN和RCNN效果差不多。
>               如下图，
> ![avatar](https://github.com/nwaiting/wolf-ai/blob/master/wolf_others/pic/sougou_feeds_multi_labels.jpg)
>
>           关键词：
>               关键词是各个分类中的实体内容
>               热点实体经过人工筛选最终选出几万的实体量，都是相关领域热门的有代表性的实体。
>               实体词需要实时进行更新。
>
>               如何发现实体并将其加入到实体集中？？？
>                   定期发掘新产生的热门词汇，通过计算给相关的标注人员推荐给可以作为标注的人们关键词，通过人工方式确定是否可以录入。
>
>               **关键词的算法抽取：！！！**
>                   解决方案是从文章中找关键词，选择与其topic相关的关键词作为代表。
>                   做关键词一般有两种模型：
>                   1、相似度模型
>                       TF-IDF
>                       LDA
>                       word2vec
>                       将词与文章都用向量表示，算出词与文章的相似度，找最相近的词
>                   2、概率模型
>                       Skip-Gram+层次softmax
>
>       关键词抽取的概率模型：
>           如下图，
> ![avatar](https://github.com/nwaiting/wolf-ai/blob/master/wolf_others/pic/sougou_feeds_keywords.jpg)
>
>           如上图，假设有一个文本S，有若干个词，条件概率越高则该词更能表达这个文本，更适合做文本关键词。
>           关键词转换概率建模：
>               将关键词做一个假设，即词与词之间转换概率的乘积，对词的转换概率的建模。
>           采用word2vec，Skip-Gram思想，输入的是文本空间，经过embedding，然后softmax全连接，最后得出一个词转换为另一个词的转换概率。
>           word2vec不要要右边的树，但是本模型主要利用树结构，算出转换概率后，根据贝叶斯假设选出概率最大的作为关键词，最终准确率能达到89%。
>
>
>

- **召回算法：**
>
>       主要是基于内容召回、基于用户、协同过滤的召回等。
>           其他还有一些早会，如地域、人口属性、搜索历史、订阅等。其他召回不依赖用户行为，对于没有用户行为的新用户你可以通过额外信息进行召回，解决冷启动问题。
>       1、内容召回：
>           显式分类、标签、关键词，比如点击周杰伦的文章，周几轮就会进入你的用户画像里面，下次刷新操作就会出现周杰伦的文章，进行排序
>           这三个维度都是人指定的，但是可以用lda等将文章分为几百几千的维度，每个维度内文章是相似的，相似原因不是认为可读的。
>           兴趣文章列表维护是内容召回的核心，有两种策略：
>               a、基于规则的
>               b、基于模型排序的
>               在召回简化为对CTR预测，使用的是LR模型
>
>       2、协同过滤召回
>           协同召回算的是item与item间的关系，并不直接算item和user的相似度。
>           而隐语模型将矩阵进行分解，变成两个矩阵，将user和item转化为同一个维度，就是对用户点击的分类，就可以直接计算item与user的相似度。
>           目前用的比较多的就是隐语模型，主要用在电影评分领域
>

- **个性化推荐：**
>
>       召回的目的是为了从亿级空间找出可以精排的集合，召回基于用户画像，因此需要对召回集合做个性化排序。
>       个性化排序大致分为几个阶段:
>           1、基于规则的，
>           2、基于LR的预估，最常用的点击率预估模型，速度快，效果好，与人工规则相比，效果提升显著
>               优化：
>               一种是GBDT+LR（Facebook提出的方法）实验过程中速度受限，对比LR优化效果不明显
>               后续用FTRL优化，思想就是在线更新LR模型，在LR模型上，效果提升明显
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>

- **待续：**
>       参考：https://mp.weixin.qq.com/s/izWqy9uNYcNKg7xJVv4SMQ
>
>
>
>
>
>
>
